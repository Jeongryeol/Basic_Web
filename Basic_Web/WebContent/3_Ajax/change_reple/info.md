# change_reple 사고과정..
#### Ajax를 이용한 웹화면의 일부분을 갱신하는 코드 작성하기

>##### 웹화면의 일부분을 갱신하기 위해서 URL수정 및 새로고침 이나 신규창을 띄우는 것이 아니라
>##### 완전히 다운로드 된 현재 화면의 일부분만을 선택적으로 갱신하고자 하여
>##### Ajax(에이잭스,synchronous JavaScript and XML)가 사용되었습니다.
>##### AjQuery를 이용해서 ajax를 다루기 때문에, jQuery소스를 입양(import)해야하니, HEAD태그를 확인하십시오.
 
 
#### 이 폴더의 화면은 news_index_ajax.jsp로부터 출발합니다.
>##### 화면은 테이블로 3개의 로우와 1의 컬럼 (TOP/NEWS/BOTTOM)으로 구성하였고, 전체크기를 결정하였습니다.
>##### 최외곽 테이블에 의해 규정된 3개의 셀의 크기를 배분하여 결정한 뒤, 각 내부에는 내부테이블을 위치시켰습니다.
>##### 별도의 내부 테이블들은 외곽선(border)과 그 색깔(bordercolor)를 가지고 영역을 WEB에 표시하였습니다.

>##### 3개의 내부테이블 중 상단(TOP)과 하단(BOTTOM)의 테이블 내부의 영역은
>##### 웹이 다운로드된 이후 변화를 줄 예정이 없습니다.
>###### 일반적으로 상단에는 로고나 메뉴바 등 공통적으로 들어가야하는 사항들이 게시되고,
>###### 하단에는 웹서비스의 소유 및 운영하고 있는 단체의 정보가 기록됩니다.

>##### 중단(NEWS)테이블에는 기사를  싣고 버튼(댓글달기)을 눌렀을때 입력영역이 보여지도록 하고자 합니다.
>##### 먼저 버튼을 생성(<input>)하면서 id를 지정해주고, 이것을 별도의 영억에 담아줍니다.(<div>)
>##### 웹의 페이지가 로딩된 이후에 클릭이후의 변화로 부터 화면을 갱신하고자 하므로,
>##### 갱신하고자하는 화면(댓글입력창)이 구현될 여역도 별도의 영역에 담아줍니다.(<div>)

>##### DOM구성이후 대응할 수 있도록 BODY영역에  $(document).ready()함수를 구현하고,
>##### 이 함수안에 버튼(댓글달기)이 클릭되었을때 수행할 내용을 함수로 지정하면 됩니다.

>##### 그 내용이 동적변화이므로 ajax로 처리되어야하며, 옵션을 다음과 같이 적용합니다.
>##### url : 처리페이지의 목적지 (댓글을 입력할 수 있는 영역이 담긴 jsp파일이 들어가면 됩니다)
>##### method : 전송방식 (GET방식이 선택되었습니다)
>##### success : 성공했을때 처리할 내용 (함수로 수행시킵니다. 지정한 영역을 가리고 드러나게 합니다.) 
>##### error : 발생한 에러에 대한 메시지를 출력하도록 합니다.
  
 
#### news_action.jsp는 댓글다는 화면을 구현합니다. 
>##### news_index_ajax.jsp에서 ajax를 통해 호출받은 news_action.jsp는
>##### <form>태그로  <table>태그를 담은 jsp문서입니다.
>##### 이렇게 하면 "news_index_ajax"에서
>##### "news_action.jsp"의해 표현된 댓글입력창 영역을 지정할 수 있습니다.
>##### 또한 "news_action.jsp"의 버튼클릭 등의 이벤트를
>##### 원본WEB화면인 "news_index_ajax"에서 처리할 수도 있습니다.

>##### 즉, 비동기객체로 구현된 다른페이지의 이벤트를 원본페이지에서 처리하고
>##### 처리된 자료를 DB연동할 페이지로 연결해서 DB로 넘기고 받을 수 있습니다. 
>##### 자세한 내용은 "news_index_ajax"의 HEAD script의 주석을 참조합니다.


#### news_InsAction.jsp은 넘겨받은 값을 DB에 연동하는 역할을 담당(한 척)합니다.
>##### "news_InsAction"는 원본페이지로부터 get방식으로 넘어온 request(원본페이지의 요청객체)를 이용해서
>##### 원본 혹은 다른 비동기객체 페이지의 객체값을 읽어올 수 있습니다. 이 페이지(page)는 Javascript이기 때문에,
>##### 읽은 값을 별도의 변수를 선언하여 담을 수 있고, 해쉬맵에 담아서 자료를 저장할 수도 있습니다.
>##### 이때 이 페이지(page)에 java API를 import하는 것을 잊으면 안됩니다~!

>##### 담아온 값을 원본화면으로 보내주기 위해서 response(요청페이지의 응답객체)를 이용해서
>##### 해당화면으로 돌아 갈 수 있습니다. :: response.sendRedirect("./news_index_ajax.jsp");

>##### 이 페이지(page)에서 담은 값을 원본페이지에서도 사용하는 방법으로는
>##### forward처리나 쿠키,세션을 이용하는 방법도 있지만,
>##### 1건을 URLEncode로 작업하는 방법을 소개합니다.

>##### 변수에 담은 정보를 URLEncoder.encoder(String,"encoding-type")으로
>##### URL에 인코딩되도록 변환시키고, 그 변환된 값을 URL에 담아서 원본페이지의 URL이 변경되도록 요청합니다.
>##### 이때, 받는쪽(원본페이지)에서는 URL의 값을 변수로 받아줘야하므로
>##### 문서 가장 앞단에서 스크립틀릿( <% %>)으로 선언한 변수에는
>##### response(DB측페이지의 요청객체)로부터 값을 담습니다. 단위테스트로 출력해봅니다.

>###### 만약 위 과정에서 인코딩에러가 발생한다면, 현재 켜진 Tomcat의 Servers폴더에 위치한 server.xml을 확인바랍니다.
>##### server.xml의 63번 connector 태그에 [ URIEncoding="EUC-KR" ] 옵션을 추가하면 해결됩니다.

   
